<!DOCTYPE html>
<html lang="en"
  data-cb-collapse-enabled=""
  data-cb-collapse-default=""
  data-cb-collapse-lines=""
  data-cb-collapse-auto-height=""
  data-cb-collapse-collapsed-height="">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />

<title>Backups en casa | Mendez Octavio</title>

<meta name="description" content="¿Qué hago si no tengo un segundo disco en mi server para realizar mis backups?" />




  <link rel="icon" type="image/x-icon" href="/icons/linux-svgrepo-com.svg" />




  <link rel="apple-touch-icon" href="/home/Octavio/Documents/portfolio/content/projects/backupEnCasa.md" />




  
    
  
    
  
    
  
    
      <link rel="manifest" href="http://localhost:1313/manifest.webmanifest" />
    
  


<link rel="stylesheet" href="/css/main.css"> 


  <link
    rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.1/css/all.min.css"
  >



  <link
    rel="stylesheet"
    href="https://cdn.jsdelivr.net/gh/devicons/devicon@v2.17.0/devicon.min.css"
  >



<link
  rel="stylesheet"
  href="https://cdn.jsdelivr.net/npm/glightbox/dist/css/glightbox.min.css"
/>


<link
  rel="stylesheet"
  href="https://cdn.jsdelivr.net/npm/justified-gallery@3.8.2/dist/css/justifiedGallery.min.css"
/>

<script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
<script>
  mermaid.initialize({ theme: "dark" });
</script>

<script>
  (function () {
    try {
      var stored = localStorage.getItem("theme");
      var systemDark =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;
      var defaultTheme =
        'dark';

      var theme =
        stored ||
        (defaultTheme === "dark"
          ? "dark"
          : defaultTheme === "light"
          ? "light"
          : systemDark
          ? "dark"
          : "light");

      document.documentElement.setAttribute("data-theme", theme);
    } catch (e) {
      document.documentElement.setAttribute("data-theme", "light");
    }
  })();
</script>




  </head>
  <body class="min-h-screen bg-bg text-text antialiased">
    <div class="flex min-h-screen flex-col">
      <header class="pt-6">
  <div class="mx-auto max-w-7xl px-4 sm:px-6">
    
    <div class="nav-shell">
      <div class="nav-inner">
        
        <a href="/" class="flex items-center gap-2">
          
            <div class="flex h-8 w-8 items-center justify-center overflow-hidden rounded-full bg-surface">
              <img
                src="/icons/linux-svgrepo-com.svg"
                alt="Mendez Octavio Benjamin"
                class="h-full w-full object-cover"
              >
            </div>
          
          <span class="text-xs font-semibold tracking-wide">
            Mendez Octavio Benjamin
          </span>
        </a>

        <div class="flex items-center gap-2">
          
          <nav class="hidden items-center gap-5 md:flex">
              <a
                href="/"
                class="nav-link link-underline flex items-center gap-1 "
              >
                
                  <i class="fa-solid fa-house text-[0.75rem]"></i>
                
                <span>Inicio</span>
              </a>
              <a
                href="/about/"
                class="nav-link link-underline flex items-center gap-1 "
              >
                
                  <i class="fa-regular fa-user text-[0.75rem]"></i>
                
                <span>Sobre Mí</span>
              </a>
              <a
                href="/projects/"
                class="nav-link link-underline flex items-center gap-1 "
              >
                
                  <i class="fa-solid fa-terminal text-[0.75rem]"></i>
                
                <span>Proyectos</span>
              </a>
          </nav>

          
          <button
  type="button"
  class="theme-toggle"
  aria-label="Toggle dark mode"
  data-theme-toggle
>
  <span data-theme-icon-light style="display: none">
    
    <svg
      xmlns="http://www.w3.org/2000/svg"
      class="h-4 w-4"
      viewBox="0 0 24 24"
      fill="none"
      stroke="currentColor"
      stroke-width="1.5"
      stroke-linecap="round"
      stroke-linejoin="round"
    >
      <circle cx="12" cy="12" r="4" />
      <path
        d="M12 3v2m0 14v2m9-9h-2M5 12H3m15.364-6.364-1.414 1.414M8.05 15.95l-1.414 1.414m0-11.314L8.05 8.05m9.9 9.9-1.414-1.414"
      />
    </svg>
  </span>

  <span data-theme-icon-dark>
    
    <svg
      xmlns="http://www.w3.org/2000/svg"
      class="h-4 w-4"
      viewBox="0 0 24 24"
      fill="none"
      stroke="currentColor"
      stroke-width="1.5"
      stroke-linecap="round"
      stroke-linejoin="round"
    >
      <path d="M21 12.79A9 9 0 0 1 12.21 3 7 7 0 1 0 21 12.79z" />
    </svg>
  </span>
</button>


          
          <button
            type="button"
            class="ml-1 inline-flex items-center justify-center rounded-full border border-border bg-bg p-2 text-muted shadow-sm hover:text-accent md:hidden"
            aria-label="Toggle navigation"
            data-mobile-nav-toggle
          >
            <span class="sr-only">Open navigation</span>
            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" viewBox="0 0 24 24" fill="none"
                 stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
              <line x1="4" y1="6" x2="20" y2="6" />
              <line x1="4" y1="12" x2="20" y2="12" />
              <line x1="4" y1="18" x2="20" y2="18" />
            </svg>
          </button>
        </div>
      </div>
    </div>
  </div>

  
  <div class="mx-auto mt-2 max-w-7xl px-4 sm:px-6 md:hidden">
    <nav
      class="hidden rounded-2xl border border-border bg-surface px-4 py-3 text-sm text-muted shadow-md"
      data-mobile-nav
    >
      
        <a href="/" class="flex items-center gap-2 py-1.5">
          
            <i class="fa-solid fa-house text-[0.8rem]"></i>
          
          <span>Inicio</span>
        </a>
      
        <a href="/about/" class="flex items-center gap-2 py-1.5">
          
            <i class="fa-regular fa-user text-[0.8rem]"></i>
          
          <span>Sobre Mí</span>
        </a>
      
        <a href="/projects/" class="flex items-center gap-2 py-1.5">
          
            <i class="fa-solid fa-terminal text-[0.8rem]"></i>
          
          <span>Proyectos</span>
        </a>
      
    </nav>
  </div>
</header>


      <main class="flex-1">
        
  <section class="layout-page section-stack">
    <div class="article-layout">
      <article class="article-main space-y-4">
        <header class="space-y-2">
          <h1 class="heading-page text-2xl sm:text-3xl">Backups en casa</h1>

          <div class="text-[0.75rem] text-muted">
            
              <span>07 Feb 2025</span>
            
            
              <span> • 3 min read</span>
            
          </div>

          
            <p class="max-w-xl text-sm text-muted">
              ¿Qué hago si no tengo un segundo disco en mi server para realizar mis backups?
            </p>
          
        </header>

        <div class="card card-pad">
          <div class="markdown-body">
            <h2 id="problematica">
  <a href="#problematica" class="md-heading-anchor">
    Problematica
  </a>
</h2>
<p>Mi servidor principal <a
  href="/projects/homelab.md"
  
  class="md-link"
>
  Abyss
</a>
 corre 24/7 alojando servicios y almacenando archivos, tanto personales como de configuración y scripts de automatización.</p>
<p>El problema no es hacer el backup, el problema es, donde lo hago si mi server no tiene un segundo disco. No tiene sentido guardar el backup en el mismo disco que los archivos importantes.</p>
<p>Decidí mandar todo el backup a mi pc principal <code>knight.hollownest.lan</code> pero surgio otro problema.
¿Qué pasa si no estoy en casa?</p>
<h2 id="solución">
  <a href="#soluci%c3%b3n" class="md-heading-anchor">
    Solución
  </a>
</h2>
<p>Desarrollé un script alojado en <strong>Abyss</strong> que automatiza el respaldo mediante tres fases lógicas:</p>
<h3 id="fase-1-gestión-de-energía-wake-on-lan">
  <a href="#fase-1-gesti%c3%b3n-de-energ%c3%ada-wake-on-lan" class="md-heading-anchor">
    Fase 1: Gestión de Energía (Wake-on-LAN)
  </a>
</h3>
<p>El script verifica el estado de <strong>Knight</strong>. Si está apagada, envía un &ldquo;Magic Packet&rdquo; (WoL) para despertarla remotamente y espera a que los servicios SSH estén disponibles.</p>
<h3 id="fase-2-sincronización-segura">
  <a href="#fase-2-sincronizaci%c3%b3n-segura" class="md-heading-anchor">
    Fase 2: Sincronización Segura
  </a>
</h3>
<p>Una vez establecida la conexión, se ejecuta <code>rsync</code> sobre SSH, realizando el backup en otro disco.</p>
<h3 id="fase-3-decisión-de-apagado-detección-de-presencia">
  <a href="#fase-3-decisi%c3%b3n-de-apagado-detecci%c3%b3n-de-presencia" class="md-heading-anchor">
    Fase 3: Decisión de Apagado (Detección de Presencia)
  </a>
</h3>
<p>Aquí reside la lógica clave del sistema. Para decidir si <strong>Knight</strong> debe volver a apagarse, el script consulta el estado de <strong>Sly</strong> (mi celular) en la red:</p>
<ul>
<li><strong>Si Sly NO responde (Offline):</strong> Se asume que estoy fuera de casa. El sistema envía la orden de apagado a <strong>Knight</strong> para ahorrar energía.</li>
<li><strong>Si Sly responde (Online):</strong> Se asume que estoy presente dentro de casa. El script finaliza <strong>sin</strong> apagar el equipo, evitando interrupciones en mi flujo de trabajo.</li>
</ul>
<h2 id="flujo-de-trabajo">
  <a href="#flujo-de-trabajo" class="md-heading-anchor">
    Flujo de trabajo
  </a>
</h2>
<p><figure class="md-image">
  <a href="/images/backup.png" class="glightbox">
    <img
      src="/images/backup.png"
      alt="Flujo de trabajo del backup"
      loading="lazy"
    />
  </a>
  
</figure>
</p>
<h2 id="script">
  <a href="#script" class="md-heading-anchor">
    Script
  </a>
</h2>
<div class="mb-codeblock" id="cb-5feceb66" data-lang="shell">
  
  <div class="mb-codeblock-header">
    <div class="mb-codeblock-left">
      <span class="mb-codeblock-badge">
        SHELL
      </span></div>

    <div class="mb-codeblock-actions"><button class="mb-action-btn mb-collapse-btn" data-collapsed="false" aria-label="Collapse code">
          <i class="fas fa-compress-alt"></i>
          <span>Collapse</span>
        </button><button class="mb-action-btn mb-copy-btn" aria-label="Copy code">
        <i class="fas fa-copy"></i>
        <span>Copy</span>
      </button>
    </div>
  </div>

  
  <div 
    class="mb-codeblock-content" 
    data-state="expanded"
  >
    <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-text-size-adjust:none;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#75715e">#!/bin/bash
</span></span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># --- CONFIGURACIÓN ---</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Host de destino (PC principal)</span>
</span></span><span style="display:flex;"><span>TARGET_HOST<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;192.168.0.100&#34;</span>
</span></span><span style="display:flex;"><span>TARGET_MAC<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;aa:bb:cc:dd:ee:ff&#34;</span>
</span></span><span style="display:flex;"><span>TARGET_USER<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;sysadmin&#34;</span>
</span></span><span style="display:flex;"><span>BACKUP_DIR<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;/home/</span>$TARGET_USER<span style="color:#e6db74">/backups/server/&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Dispositivo de control (Celular para detección de presencia)</span>
</span></span><span style="display:flex;"><span>PRESENCE_DEVICE<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;192.168.0.150&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Directorios a respaldar</span>
</span></span><span style="display:flex;"><span>SOURCE_FILES<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;/opt/docker/configs&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># --- LÓGICA DEL WORKFLOW ---</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>echo <span style="color:#e6db74">&#34;[INFO] Iniciando protocolo de respaldo...&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 1. VERIFICACIÓN DE ESTADO (WAKE-ON-LAN)</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> ping -c <span style="color:#ae81ff">1</span> -W <span style="color:#ae81ff">1</span> <span style="color:#e6db74">&#34;</span>$TARGET_HOST<span style="color:#e6db74">&#34;</span> &amp;&gt; /dev/null; <span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>    echo <span style="color:#e6db74">&#34;[STATUS] El host </span>$TARGET_HOST<span style="color:#e6db74"> está ENCENDIDO.&#34;</span>
</span></span><span style="display:flex;"><span>    INITIAL_STATE<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;on&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">else</span>
</span></span><span style="display:flex;"><span>    echo <span style="color:#e6db74">&#34;[STATUS] El host </span>$TARGET_HOST<span style="color:#e6db74"> está APAGADO. Enviando Magic Packet...&#34;</span>
</span></span><span style="display:flex;"><span>    wakeonlan <span style="color:#e6db74">&#34;</span>$TARGET_MAC<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>    INITIAL_STATE<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;off&#34;</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Esperar a que el host inicie servicios (SSH)</span>
</span></span><span style="display:flex;"><span>    echo <span style="color:#e6db74">&#34;[WAIT] Esperando inicio del sistema (120s)...&#34;</span>
</span></span><span style="display:flex;"><span>    sleep <span style="color:#ae81ff">120</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fi</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 2. EJECUCIÓN DEL BACKUP (RSYNC)</span>
</span></span><span style="display:flex;"><span>echo <span style="color:#e6db74">&#34;[TASK] Sincronizando archivos...&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Se asume autenticación por llave SSH</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> rsync -avz --delete <span style="color:#e6db74">&#34;</span>$SOURCE_FILES<span style="color:#e6db74">&#34;</span> <span style="color:#e6db74">&#34;</span>$TARGET_USER<span style="color:#e6db74">@</span>$TARGET_HOST<span style="color:#e6db74">:</span>$BACKUP_DIR<span style="color:#e6db74">&#34;</span>; <span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>    echo <span style="color:#e6db74">&#34;[SUCCESS] Respaldo completado correctamente.&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">else</span>
</span></span><span style="display:flex;"><span>    echo <span style="color:#e6db74">&#34;[ERROR] Falló la transferencia rsync.&#34;</span>
</span></span><span style="display:flex;"><span>    exit <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fi</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 3. GESTIÓN DE ENERGÍA (PRESENCE CHECK)</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Si la PC se encendió solo para el backup, decidimos si apagarla.</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> <span style="color:#f92672">[</span> <span style="color:#e6db74">&#34;</span>$INITIAL_STATE<span style="color:#e6db74">&#34;</span> <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;off&#34;</span> <span style="color:#f92672">]</span>; <span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>    echo <span style="color:#e6db74">&#34;[CHECK] Verificando presencia del usuario...&#34;</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Si el dispositivo móvil NO responde ping, no estoy.</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> ! ping -c <span style="color:#ae81ff">1</span> -W <span style="color:#ae81ff">1</span> <span style="color:#e6db74">&#34;</span>$PRESENCE_DEVICE<span style="color:#e6db74">&#34;</span> &amp;&gt; /dev/null; <span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>        echo <span style="color:#e6db74">&#34;[AUTO] Usuario ausente. Apagando host remoto para ahorrar energía.&#34;</span>
</span></span><span style="display:flex;"><span>        ssh -t <span style="color:#e6db74">&#34;</span>$TARGET_USER<span style="color:#e6db74">@</span>$TARGET_HOST<span style="color:#e6db74">&#34;</span> <span style="color:#e6db74">&#34;sudo shutdown -h now&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span>
</span></span><span style="display:flex;"><span>        echo <span style="color:#e6db74">&#34;[AUTO] Usuario detectado en la red. El host permanecerá encendido.&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">fi</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">else</span>
</span></span><span style="display:flex;"><span>    echo <span style="color:#e6db74">&#34;[INFO] El host ya estaba encendido previamente. No se requiere acción de apagado.&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fi</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>echo <span style="color:#e6db74">&#34;[INFO] Fin del proceso.&#34;</span></span></span></code></pre></div><div class="mb-collapse-overlay">
        <button class="mb-expand-trigger">
          <i class="fas fa-chevron-down"></i>
          <span>Click to expand</span>
        </button>
      </div></div>
</div>

<script>
(function() {
  'use strict';
  
  const codeblock = document.getElementById('cb-5feceb66');
  if (!codeblock) return;

  const copyBtn = codeblock.querySelector('.mb-copy-btn');
  const collapseBtn = codeblock.querySelector('.mb-collapse-btn');
  const content = codeblock.querySelector('.mb-codeblock-content');
  const overlay = codeblock.querySelector('.mb-collapse-overlay');
  const expandTrigger = overlay?.querySelector('.mb-expand-trigger');

  
  
  
  if (copyBtn) {
    copyBtn.addEventListener('click', async function() {
      let codeText = '';

      
      const codeCell = codeblock.querySelector('.lntd:last-child code');
      if (codeCell) {
        codeText = codeCell.textContent || codeCell.innerText || '';
      } else {
        
        const codeEl = codeblock.querySelector('pre code');
        codeText = codeEl ? (codeEl.textContent || codeEl.innerText || '') : '';
      }

      try {
        await navigator.clipboard.writeText(codeText.trim());
        
        
        const originalHTML = copyBtn.innerHTML;
        copyBtn.innerHTML = '<i class="fas fa-check"></i><span>Copied!</span>';
        copyBtn.classList.add('mb-btn-success');
        
        setTimeout(() => {
          copyBtn.innerHTML = originalHTML;
          copyBtn.classList.remove('mb-btn-success');
        }, 2000);
      } catch (err) {
        console.error('Failed to copy code:', err);
        
        
        const textArea = document.createElement('textarea');
        textArea.value = codeText.trim();
        textArea.style.position = 'fixed';
        textArea.style.opacity = '0';
        document.body.appendChild(textArea);
        textArea.select();
        
        try {
          document.execCommand('copy');
          copyBtn.innerHTML = '<i class="fas fa-check"></i><span>Copied!</span>';
          setTimeout(() => {
            copyBtn.innerHTML = '<i class="fas fa-copy"></i><span>Copy</span>';
          }, 2000);
        } catch (fallbackErr) {
          console.error('Fallback copy failed:', fallbackErr);
        }
        
        document.body.removeChild(textArea);
      }
    });
  }

  
  
  
  if (collapseBtn && content && overlay) {
    const collapsedHeight =  200 ;
    
    function toggleCollapse() {
      const isCollapsed = content.dataset.state === 'collapsed';
      
      if (isCollapsed) {
        
        content.style.maxHeight = '';
        content.style.overflow = '';
        content.dataset.state = 'expanded';
        overlay.style.display = 'none';
        collapseBtn.innerHTML = '<i class="fas fa-compress-alt"></i><span>Collapse</span>';
        collapseBtn.dataset.collapsed = 'false';
      } else {
        
        content.style.maxHeight = collapsedHeight + 'px';
        content.style.overflow = 'hidden';
        content.dataset.state = 'collapsed';
        overlay.style.display = 'flex';
        collapseBtn.innerHTML = '<i class="fas fa-expand-alt"></i><span>Expand</span>';
        collapseBtn.dataset.collapsed = 'true';
      }
    }

    
    if ('expanded' === 'collapsed') {
      content.dataset.state = 'collapsed';
      overlay.style.display = 'flex';
      collapseBtn.innerHTML = '<i class="fas fa-expand-alt"></i><span>Expand</span>';
      collapseBtn.dataset.collapsed = 'true';
    }

    collapseBtn.addEventListener('click', toggleCollapse);
    
    if (expandTrigger) {
      expandTrigger.addEventListener('click', toggleCollapse);
    }
  }
})();
</script>

<style>
 

.mb-codeblock-filename {
  display: inline-flex;
  align-items: center;
  gap: 0.35rem;
  color: var(--color-text);
  font-size: 0.75rem;
  font-weight: 500;
  padding: 0.2rem 0.6rem;
  border-radius: 0.35rem;
  background: color-mix(in srgb, var(--color-bg) 40%, transparent);
  border: 1px solid color-mix(in srgb, var(--color-border) 60%, transparent);
}

.mb-action-btn {
  display: inline-flex;
  align-items: center;
  gap: 0.35rem;
  background: transparent;
  border: 1px solid color-mix(in srgb, var(--color-border) 70%, transparent);
  color: var(--color-text-muted);
  cursor: pointer;
  font-size: 0.7rem;
  padding: 0.35rem 0.65rem;
  border-radius: 0.4rem;
  transition: all 0.15s ease-out;
  font-family: inherit;
}

.mb-action-btn:hover {
  color: var(--color-accent);
  background: color-mix(in srgb, var(--color-accent) 12%, transparent);
  border-color: var(--color-accent);
  transform: translateY(-1px);
}

.mb-action-btn:active {
  transform: translateY(0);
}

.mb-action-btn i {
  font-size: 0.7rem;
}

.mb-btn-success {
  color: #22c55e !important;
  border-color: #22c55e !important;
  background: color-mix(in srgb, #22c55e 12%, transparent) !important;
}

.mb-collapse-overlay {
  display: none;
  position: absolute;
  inset: 0;
  background: linear-gradient(
    to bottom,
    transparent 0%,
    rgba(0, 0, 0, 0.3) 40%,
    rgba(0, 0, 0, 0.85) 100%
  );
  align-items: flex-end;
  justify-content: center;
  padding-bottom: 1rem;
  cursor: pointer;
  z-index: 10;
}

.mb-expand-trigger {
  display: inline-flex;
  align-items: center;
  gap: 0.4rem;
  padding: 0.4rem 0.8rem;
  border-radius: 0.5rem;
  border: 1px solid var(--color-accent);
  background: color-mix(in srgb, var(--color-accent) 20%, transparent);
  color: var(--color-accent);
  font-size: 0.75rem;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.15s ease-out;
  backdrop-filter: blur(8px);
}

.mb-expand-trigger:hover {
  background: color-mix(in srgb, var(--color-accent) 30%, transparent);
  transform: translateY(-2px);
  box-shadow: 0 4px 12px rgba(168, 85, 247, 0.3);
}

.mb-expand-trigger i {
  font-size: 0.7rem;
  animation: bounce 1.5s infinite;
}

@keyframes bounce {
  0%, 100% {
    transform: translateY(0);
  }
  50% {
    transform: translateY(3px);
  }
}

 
.mb-codeblock[data-lang="javascript"] .mb-codeblock-badge,
.mb-codeblock[data-lang="js"] .mb-codeblock-badge {
  background: color-mix(in srgb, #f7df1e 25%, transparent);
  color: #f7df1e;
}

.mb-codeblock[data-lang="typescript"] .mb-codeblock-badge,
.mb-codeblock[data-lang="ts"] .mb-codeblock-badge {
  background: color-mix(in srgb, #3178c6 25%, transparent);
  color: #3178c6;
}

.mb-codeblock[data-lang="python"] .mb-codeblock-badge,
.mb-codeblock[data-lang="py"] .mb-codeblock-badge {
  background: color-mix(in srgb, #3776ab 25%, transparent);
  color: #3776ab;
}

.mb-codeblock[data-lang="go"] .mb-codeblock-badge {
  background: color-mix(in srgb, #00add8 25%, transparent);
  color: #00add8;
}

.mb-codeblock[data-lang="rust"] .mb-codeblock-badge,
.mb-codeblock[data-lang="rs"] .mb-codeblock-badge {
  background: color-mix(in srgb, #ce422b 25%, transparent);
  color: #ce422b;
}

.mb-codeblock[data-lang="html"] .mb-codeblock-badge {
  background: color-mix(in srgb, #e34c26 25%, transparent);
  color: #e34c26;
}

.mb-codeblock[data-lang="css"] .mb-codeblock-badge {
  background: color-mix(in srgb, #264de4 25%, transparent);
  color: #264de4;
}

.mb-codeblock[data-lang="bash"] .mb-codeblock-badge,
.mb-codeblock[data-lang="sh"] .mb-codeblock-badge,
.mb-codeblock[data-lang="shell"] .mb-codeblock-badge {
  background: color-mix(in srgb, #4eaa25 25%, transparent);
  color: #4eaa25;
}

.mb-codeblock[data-lang="json"] .mb-codeblock-badge {
  background: color-mix(in srgb, #000000 25%, transparent);
  color: #dddddd;
}

.mb-codeblock[data-lang="yaml"] .mb-codeblock-badge,
.mb-codeblock[data-lang="yml"] .mb-codeblock-badge {
  background: color-mix(in srgb, #cb171e 25%, transparent);
  color: #cb171e;
}
</style><p>Para finalizar este script corre de forma automatizada, definiendo su ejecución en el archivo <code>/etc/crontab</code></p>

          </div>
        </div>
      </article>

      
        <aside class="article-toc">
          <div class="toc-wrapper">
            <div class="toc-header">
              <h3 class="toc-title">
                <i class="fas fa-list-ul"></i>
                <span>Table of Contents</span>
              </h3>
              <button class="toc-toggle" aria-label="Toggle table of contents">
                <i class="fas fa-chevron-down"></i>
              </button>
            </div>
            <nav class="toc-nav">
              <nav id="TableOfContents">
  <ul>
    <li><a href="#problematica">Problematica</a></li>
    <li><a href="#solución">Solución</a>
      <ul>
        <li><a href="#fase-1-gestión-de-energía-wake-on-lan">Fase 1: Gestión de Energía (Wake-on-LAN)</a></li>
        <li><a href="#fase-2-sincronización-segura">Fase 2: Sincronización Segura</a></li>
        <li><a href="#fase-3-decisión-de-apagado-detección-de-presencia">Fase 3: Decisión de Apagado (Detección de Presencia)</a></li>
      </ul>
    </li>
    <li><a href="#flujo-de-trabajo">Flujo de trabajo</a></li>
    <li><a href="#script">Script</a></li>
  </ul>
</nav>
            </nav>
          </div>
        </aside>

        <script>
        (function() {
          'use strict';

          const tocWrapper = document.querySelector('.toc-wrapper');
          const tocToggle = document.querySelector('.toc-toggle');
          const tocNav = document.querySelector('.toc-nav');
          const tocLinks = document.querySelectorAll('.toc-nav a');

          if (!tocWrapper || !tocNav) return;

          
          
          
          if (tocToggle) {
            tocToggle.addEventListener('click', function() {
              tocWrapper.classList.toggle('collapsed');
            });
          }

          
          
          
          tocLinks.forEach(link => {
            link.addEventListener('click', function(e) {
              e.preventDefault();
              const targetId = this.getAttribute('href');
              const targetElement = document.querySelector(targetId);

              if (targetElement) {
                const yOffset = -80; 
                const y = targetElement.getBoundingClientRect().top + window.pageYOffset + yOffset;

                window.scrollTo({
                  top: y,
                  behavior: 'smooth'
                });

                
                history.pushState(null, null, targetId);
              }
            });
          });

          
          
          
          const headings = document.querySelectorAll('.markdown-body h1[id], .markdown-body h2[id], .markdown-body h3[id], .markdown-body h4[id], .markdown-body h5[id], .markdown-body h6[id]');

          let activeHeading = null;
          const observer = new IntersectionObserver(
            (entries) => {
              
              const intersectingHeadings = [];
              entries.forEach((entry) => {
                if (entry.isIntersecting) {
                  intersectingHeadings.push({
                    element: entry.target,
                    top: entry.boundingClientRect.top
                  });
                }
              });

              
              if (intersectingHeadings.length > 0) {
                
                intersectingHeadings.sort((a, b) => Math.abs(a.top) - Math.abs(b.top));

                const closestHeading = intersectingHeadings[0].element;
                const id = closestHeading.getAttribute('id');

                if (id && id !== activeHeading) {
                  activeHeading = id;
                  const tocLink = document.querySelector(`.toc-nav a[href="#${id}"]`);

                  if (tocLink) {
                    
                    tocLinks.forEach(link => link.classList.remove('active'));
                    
                    tocLink.classList.add('active');
                  }
                }
              }
            },
            {
              rootMargin: '-80px 0px -80%',
              threshold: [0, 0.25, 0.5, 0.75, 1]
            }
          );

          
          headings.forEach((heading) => {
            observer.observe(heading);
          });

          
          if (tocLinks.length > 0) {
            tocLinks[0].classList.add('active');
            activeHeading = tocLinks[0].getAttribute('href').substring(1);
          }
        })();
        </script>
      
    </div>
  </section>

      </main>

      <footer class="pb-6 pt-10">
  <div class="mx-auto max-w-7xl px-4 sm:px-6">
    <div class="footer-shell">
      <div class="footer-inner">
        
        <div class="space-y-1">
          <p class="footer-small">
            &copy; 2026 Mendez Octavio — All rights
            reserved.
          </p>

          <p class="footer-small flex flex-wrap items-center gap-1">
            <span>Built with</span>

            <a
              href="https://gohugo.io/"
              class="footer-link footer-float link-underline"
              target="_blank"
              rel="noopener noreferrer"
            >
              <span>Hugo</span>
            </a>

            <span>/</span>

            <a
              href=""
              class="footer-link footer-float link-underline"
              target="_blank"
              rel="noopener noreferrer"
            >
              <span>Minimal&nbsp;Black</span>
            </a>
          </p>
        </div>

        
        
        <div class="footer-links">
          
          <a
            href="https://github.com/octaviobenjamin"
            class="footer-link footer-float link-underline"
            target="_blank"
            rel="noopener noreferrer"
          >
            <i class="fa-brands fa-github text-[0.8rem]"></i>
            <span>GitHub</span>
          </a>
          
          <a
            href="https://www.linkedin.com/in/octaviobenjamin/"
            class="footer-link footer-float link-underline"
            target="_blank"
            rel="noopener noreferrer"
          >
            <i class="fa-brands fa-linkedin-in text-[0.8rem]"></i>
            <span>LinkedIn</span>
          </a>
          
        </div>
        
      </div>
    </div>
  </div>
</footer>

    </div>
    <div class="search-overlay" data-search-overlay>
  <div class="search-overlay-backdrop" data-search-close></div>

  <div class="search-panel">
    <div class="search-panel-header">
      <div class="search-input-wrap">
        <i class="fa-solid fa-magnifying-glass text-[0.8rem] text-muted"></i>
        <input
          type="search"
          class="search-input"
          placeholder="Search posts..."
          autocomplete="off"
          data-search-input
        />
      </div>
      <button
        type="button"
        class="search-close"
        data-search-close
        aria-label="Close search"
      >
        <i class="fa-solid fa-xmark text-[0.8rem]"></i>
      </button>
    </div>

    <div class="search-panel-body">
      <div class="search-results" data-search-results>
        <div class="search-empty-state">
          <div class="search-empty-icon">
            <i class="fa-solid fa-magnifying-glass text-[1rem]"></i>
          </div>
          <p class="search-empty-title">Start searching</p>
          <p class="search-empty-subtitle">
            Enter keywords to search articles.
          </p>
        </div>
      </div>

      <div class="search-footer-hints">
        <div class="search-hint-key">
          <span>↑↓</span>
          <span>Navigate</span>
        </div>
        <div class="search-hint-key">
          <span>↵</span>
          <span>Select</span>
        </div>
        <div class="search-hint-key">
          <span>ESC</span>
          <span>Close</span>
        </div>
        <div class="search-hint-key search-hint-right">
          <span>Ctrl</span><span>K</span>
          <span>Shortcut</span>
        </div>
      </div>
    </div>
  </div>
</div>

    <div class="dock" data-dock>
  <div class="dock-inner">
    
    <div class="dock-panel" data-dock-panel>
      
      
      <button
        type="button"
        class="dock-action"
        data-dock-action="back"
        aria-label="Go back"
      >
        <i class="fa-solid fa-arrow-left text-[0.7rem]"></i>
      </button>
      <span class="dock-divider" aria-hidden="true"></span>
      

      
      <button
        type="button"
        class="dock-action"
        data-dock-action="search"
        aria-label="Search"
        onclick="window.MinimalSearch && window.MinimalSearch.open()"
      >
        <i class="fa-solid fa-magnifying-glass text-[0.7rem]"></i>
      </button>

      
      <span class="dock-divider" aria-hidden="true"></span>

      
      <button
        type="button"
        class="dock-action"
        data-dock-action="top"
        aria-label="Back to top"
      >
        <i class="fa-solid fa-arrow-up text-[0.7rem]"></i>
      </button>
    </div>

    
    <button
      type="button"
      class="dock-toggle"
      aria-label="Open quick actions"
      data-dock-toggle
    >
      <span class="dock-toggle-dots"></span>
    </button>
  </div>
</div>

    <script src="/js/main.js" defer></script>
    <script src="/js/search.js" defer></script>
    <script src="https://cdn.jsdelivr.net/npm/glightbox/dist/js/glightbox.min.js" defer></script>
    <script src="https://cdn.jsdelivr.net/npm/justified-gallery@3.8.2/dist/js/justifiedGallery.min.js" defer></script>
    <script src="/js/lightbox.js" defer></script>
    <script src="/js/gallery.js" defer></script>
  </body>
</html>
